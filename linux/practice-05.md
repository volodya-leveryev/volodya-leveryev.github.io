---
layout: default
title: Работа с пользователями
---
# Работа с пользователями

## Цель работы

Получить опыт администрирования пользователей в Linux.

## Подготовка

Создайте отчет в формате *.doc.

Перед началом работы вам нужно получить у преподавателя:

* адрес сервера
* имя пользователя
* закрытый ключ

Подключитесь к серверу по SSH.

## Ход работы

1. Создайте нового пользователя с помощью утилиты `adduser`.

    ```
    sudo adduser <логин>
    ```

2. Создайте нового пользователя с помощью утилиты `useradd`.

    ```
    sudo useradd <логин>
    sudo cp -r /etc/skel /home/<логин>
    sudo chown -R <логин>:<логин> /home/<логин>
    sudo chsh -s /bin/bash <login>
    sudo usermod -p <пароль> <логин>
    ```

    Запишите в отчет назначение команд из пунктов 1 и 2.

    Какой ключ команды useradd позволяет создать домашний каталог пользователя?

    Какой ключ команды useradd позволяет задать оболочку пользователя?

3. Создайте новый ключ, разрешите новому пользователю вход на сервер с помощью этого ключа и проверьте это.

    На локальной машине (в `Git Bash` вместо `type` используйте `cat`):
    ```
    ssh-keygen -t <тип ключа> -f <имя файла ключа> -С "<комментарий>"
    type <имя файла ключа>
    ```

    На сервере:

    ```
    sudo -i -u <логин>
    mkdir ~/.ssh
    nano ~/.ssh/authorized_keys
    ```

    На локальном компьютере:
    ```
    ssh -i <имя файла ключа> <логин>@<сервер>
    ```

4. Добавьте пользователя в группу `sudo`.

    ```
    id <login>
    sudo usermod -a -G sudo <login> 
    id <login>
    ```

    Снова войдите под новым пользователем и проверьте что команда `sudo` работает.

7. Проверте список подключенных пользователей

    ```
    w
    who
    users
    last
    ```

8. Убедитесь, что у вас открыто два окна терминала под разными пользователями и отправьте текстовое сообщение от одного пользователю другому:

    ```
    write
    wall
    ```

9. Изменить права доступа на файл и каталог

    ```
    touch test_file
    ls -l test_file
    chmod ??? test_file
    rwx------ 700
    rw-r--r-- 644
    rwxr-xr-x 755
    --S--S--T 7000
    ```

10. Изменить владельца файла и каталога

    ```
    cd /tmp/task
    sudo chown <логин> <файл>
    sudo chgrp <группа> <файл>
    ```

11. Написать скрипт для автоматического создания 10 пользователей

    ```
    cd ~
    nano script

    for ((i = 1; i < 11; i++))
    do
    useradd -m -p 123 <логин>$i
    done

    sudo bash script
    less /etc/passwd
```
