DNS и DHCP
===========

Теоретическая часть
-------------------

Протокол DNS позволяет узнать IP-адрес по доменному имени компьютера. DNS использует порт 53 протокола UDP.

Протокол DHCP позволяет автоматически сконфигурировать IP-адреса компьютеров в локальной сети. DHCP использует порты 67 и 68 протокола UDP.

Чаще всего назначаются следующие сетевые настройки:
- IP-адрес (обязательно)
- Маска сети (обязательно)
- Адрес шлюза
- Адрес DNS-сервера (можно несколько)
- Имя домена
- Параметры загрузки ОС по сети (PXE)
- И другие

Типы запросов DHCP:
- **DISCOVER - клиент запрашивает сетевые настройки**
- **OFFER - серверы предлагают сетевые настройки**
- **REQUEST - клиент запрашивает аренду предложенных сетевых настроек**
- **ACK - сервер оповещает о назначении сетевых настроек**
- NAK - сервер оповещает об отказе в назначении сетевых настроек (например, клиент опоздал и настройки уже назначены другому клиенту)
- RELEASE - клиент запрашивает освобождение сетевых настроек
- DECLINE - клиент отказывается от назначенных сетевых настроек

Для работы DHCP-сервера необходим статический IP-адрес.

Добавление роли DHCP-сервера:
- Через PowerShell: `Install-WindowsFeature`
- Через Диспетчер сервера: Управление, Добавить роль, DHCP-сервер

IP-адреса арендуются на определенный срок. В условиях частой смены клиентов выгоднее назначить короткий срок аренды, чтобы заново использовать IP-адреса после их освобождения. Если клиенты меняются редко, тогда можно уменьшить нагрузку на DHCP-сервер, увеличив срок аренды.

Практическая часть
------------------

1. Подключиться к Windows Server
2. Установить роли Hyper-V (если поддерживается Hyper-V)
   Перезагрузить Windows Server
   Создать виртуальный коммутатор типа Internal
   Настроить статический IP-адрес на сетевом адаптере, подключенном к виртуальному коммутатору
3. Установить роли DNS и DHCP
4. Настроить DHCP-сервер
   - a. Изменить привязки, чтобы он обслуживал только виртуальный коммутатор (если поддерживается Hyper-V)
   - b. Диапазон адресов: 192.168.1.1 - 192.168.1.254 с маской 255.255.255.0
   - c. Исключить из выдачи адреса 192.168.1.1 - 192.168.1.10
   - d. Настроить название домена example.com
   - e. Настроить шлюз 192.168.1.1
   - f. Настроить DNS-сервер 192.168.1.1
5. Настроить DNS-сервер:
   - a. Создать зону прямого просмотра example.com
   - b. Создать несколько записей типа A
   - c. Создать несколько записей типа CNAME, указывающих на записи типа A
6. Открыть PowerShell (если поддерживается Hyper-V)
   - a. `Start-BitsTransfer -Source https://mirror.anigil.com/archlinux/iso/2023.02.01/archlinux-2023.02.01-x86_64.iso`
7. Создать виртуальную машину и загрузиться со скачанного загрузочного диска (если поддерживается Hyper-V)
8. Проверить работу DHCP-сервера (если поддерживается Hyper-V)
   - `dhclient -v eth0`
9. Проверить работу DNS-клиента
   - `nslookup`

Отчетность
----------

Сделайте скриншоты:
- Server Manager Dashboard так, чтобы были видны службы установленных ролей DNS и DHCP
- Консоль DHCP со Scope на странице с диапазоном IP-адресов
- Консоль DHCP со Scope на странице с опциями DHCP
- Консоль DNS с адресами зоны прямого просмотра
- Окно терминала с nslookup-запросами по адресам из настроенной зоны example.com к серверу 127.0.0.1
